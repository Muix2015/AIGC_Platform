<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•…äº‹å¤§çº²ç”Ÿæˆ - AIåˆ›æ„åŠ¨ç”»å¹³å°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "PingFang SC", "Microsoft YaHei", "Helvetica Neue", "Helvetica", "Arial", sans-serif;
            background: linear-gradient(135deg, #0f1419 0%, #1a237e 50%, #283593 100%);
            min-height: 100vh;
            color: #ffffff;
            overflow-x: hidden;
            position: relative;
        }

        /* ç²’å­èƒŒæ™¯åŠ¨ç”» */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #00E5FF;
            border-radius: 50%;
            animation: float 25s infinite linear;
        }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }

        /* å®¹å™¨å¸ƒå±€ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 10;
        }

        /* å¤´éƒ¨å¯¼èˆª */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            margin-bottom: 24px;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #00A8FF;
            text-shadow: 0 0 20px rgba(0, 168, 255, 0.5);
        }

        .progress-bar {
            flex: 1;
            margin: 0 32px;
            background: rgba(255, 255, 255, 0.1);
            height: 4px;
            border-radius: 2px;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .progress-fill {
            width: 37.5%;
            height: 100%;
            background: linear-gradient(90deg, #00A8FF, #00E5FF);
            border-radius: 2px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .step-info {
            font-size: 14px;
            color: #90A4AE;
        }

        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 24px;
            min-height: calc(100vh - 200px);
        }

        /* å·¦ä¾§å¤§çº²å±•ç¤ºåŒº */
        .outline-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(79, 195, 247, 0.2);
            border-radius: 16px;
            padding: 24px;
            position: relative;
        }

        .section-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, #00A8FF, #FFC107);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .ai-indicator {
            margin-right: 10px;
            background: linear-gradient(135deg, #7C4DFF, #00A8FF);
            border-radius: 12px;
            padding: 4px 12px;
            font-size: 12px;
            color: #fff !important;
            font-weight: 600;
            animation: glow 2s infinite alternate;
            -webkit-text-fill-color: #fff !important;
        }

        @keyframes glow {
            0% { box-shadow: 0 0 5px rgba(124, 77, 255, 0.5); }
            100% { box-shadow: 0 0 20px rgba(124, 77, 255, 0.8); }
        }

        .regenerate-btn {
            background: linear-gradient(135deg, #00A8FF, #0078D4);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .regenerate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 168, 255, 0.4);
        }

        /* æ—¶é—´çº¿å¤§çº² */
        .timeline {
            position: relative;
            padding-left: 40px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(180deg, #00A8FF, #7C4DFF, #FFC107);
            border-radius: 1px;
        }

        .chapter {
            position: relative;
            margin-bottom: 32px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chapter:hover {
            transform: translateX(5px);
            border-color: #00E5FF;
            box-shadow: 0 5px 20px rgba(0, 229, 255, 0.2);
        }

        .chapter::before {
            content: '';
            position: absolute;
            left: -30px;
            top: 24px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 2px solid #00A8FF;
            background: #ffffff;
        }

        .chapter.beginning::before { background: #00A8FF; }
        .chapter.development::before { background: #7C4DFF; }
        .chapter.climax::before { background: #FF5722; }
        .chapter.ending::before { background: #FFC107; }

        .chapter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .chapter-title {
            font-size: 18px;
            font-weight: 600;
            color: #00E5FF;
        }

        .chapter-type {
            background: rgba(124, 77, 255, 0.3);
            border: 1px solid rgba(124, 77, 255, 0.5);
            border-radius: 16px;
            padding: 4px 12px;
            font-size: 12px;
            color: #90A4AE;
        }

        .chapter-content {
            font-size: 14px;
            line-height: 1.6;
            color: #ffffff;
            margin-bottom: 16px;
        }

        .chapter-tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .tag {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid rgba(255, 193, 7, 0.4);
            border-radius: 12px;
            padding: 4px 8px;
            font-size: 12px;
            color: #FFC107;
        }

        .security-tag {
            background: rgba(0, 230, 118, 0.2);
            border: 1px solid rgba(0, 230, 118, 0.4);
            color: #00E676;
        }

        /* å³ä¾§ç¼–è¾‘æ§åˆ¶åŒº */
        .control-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(79, 195, 247, 0.2);
            border-radius: 16px;
            padding: 20px;
        }

        .panel-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #00E5FF;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* AIåŠ©æ‰‹é¢æ¿ */
        .ai-assistant {
            text-align: center;
            margin-bottom: 16px;
        }

        .ai-avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #7C4DFF, #00A8FF);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin: 0 auto 12px;
            animation: bounce 3s infinite;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(124, 77, 255, 0.4);
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }

        .ai-message {
            background: rgba(124, 77, 255, 0.1);
            border: 1px solid rgba(124, 77, 255, 0.3);
            border-radius: 12px;
            padding: 12px;
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 12px;
        }

        .ai-suggestions {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .suggestion-btn {
            background: rgba(0, 168, 255, 0.1);
            border: 1px solid rgba(0, 168, 255, 0.3);
            border-radius: 8px;
            padding: 8px 12px;
            color: #00A8FF;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s ease;
            text-align: left;
        }

        .suggestion-btn:hover {
            background: rgba(0, 168, 255, 0.2);
            transform: scale(1.02);
        }

        /* ç¼–è¾‘é¢æ¿ */
        .edit-controls {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .control-btn {
            background: linear-gradient(135deg, #00A8FF, #0078D4);
            border: none;
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 168, 255, 0.4);
        }

        .control-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .control-btn.danger {
            background: linear-gradient(135deg, #FF5252, #D32F2F);
        }

        /* æ•…äº‹ç»Ÿè®¡é¢æ¿ */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: #FFC107;
            display: block;
        }

        .stat-label {
            font-size: 12px;
            color: #90A4AE;
            margin-top: 4px;
        }

        /* ç½‘ç»œå®‰å…¨æ•™è‚²é¢æ¿ */
        .security-panel {
            background: linear-gradient(135deg, rgba(0, 230, 118, 0.1), rgba(0, 230, 118, 0.05));
            border: 1px solid rgba(0, 230, 118, 0.3);
        }

        .security-tip {
            background: rgba(0, 230, 118, 0.1);
            border-radius: 8px;
            padding: 12px;
            font-size: 14px;
            line-height: 1.5;
            display: flex;
            gap: 8px;
        }

        .security-icon {
            color: #00E676;
            font-size: 16px;
        }

        /* åº•éƒ¨æ“ä½œåŒº */
        .bottom-actions {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(15, 20, 25, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(79, 195, 247, 0.2);
            padding: 16px;
            z-index: 100;
        }

        .action-buttons {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
        }

        .btn-group {
            display: flex;
            gap: 12px;
        }

        .btn-secondary, .btn-primary {
            padding: 12px 32px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-primary {
            background: linear-gradient(135deg, #00A8FF, #7C4DFF);
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(0, 168, 255, 0.3);
        }

        .btn-secondary:hover, .btn-primary:hover {
            transform: translateY(-2px);
        }

        .btn-primary:hover {
            box-shadow: 0 6px 20px rgba(0, 168, 255, 0.4);
        }

        /* æ¨¡æ€æ¡† */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(79, 195, 247, 0.3);
            border-radius: 16px;
            padding: 40px;
            max-width: 800px;
            width: 95%;
            max-height: 80vh;
            overflow-y: auto;
            text-align: center;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 24px;
            color: #00E5FF;
        }

        .modal-text {
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 24px;
            color: #ffffff;
        }

        .modal-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 24px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto;
            }

            .control-section {
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 16px;
            }

            .header {
                flex-direction: column;
                gap: 16px;
            }

            .progress-bar {
                margin: 0;
                order: -1;
            }

            .section-title {
                font-size: 20px;
            }

            .timeline {
                padding-left: 30px;
            }

            .timeline::before {
                left: 15px;
            }

            .chapter::before {
                left: -25px;
            }

            .bottom-actions {
                padding: 12px;
            }

            .action-buttons {
                flex-direction: column;
                gap: 12px;
            }

            .btn-group {
                width: 100%;
                justify-content: center;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #00E5FF;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }

        /* ç¼–è¾‘æ¨¡å¼æ ·å¼ */
        .editing {
            border-color: #00E5FF !important;
            box-shadow: 0 0 20px rgba(0, 229, 255, 0.3) !important;
        }

        .edit-textarea {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(79, 195, 247, 0.3);
            border-radius: 8px;
            padding: 16px;
            color: #ffffff;
            font-size: 16px;
            line-height: 1.6;
            resize: vertical;
            min-height: 200px;
            height: 300px;
            font-family: inherit;
            box-sizing: border-box;
        }

        .edit-textarea:focus {
            outline: none;
            border-color: #00E5FF;
            box-shadow: 0 0 10px rgba(0, 229, 255, 0.3);
        }

        .edit-textarea::placeholder {
            color: #90A4AE;
        }
    </style>
</head>
<body>
    <!-- ç²’å­èƒŒæ™¯ -->
    <div class="particles" id="particles"></div>

    <div class="container">
        <!-- å¤´éƒ¨å¯¼èˆª -->
        <header class="header">
            <div class="logo">ğŸŒŸ AIåˆ›æ„å·¥åœº</div>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <div class="step-info">æ­¥éª¤ 3/8: æ•…äº‹å¤§çº²ç”Ÿæˆ</div>
        </header>

        <!-- ä¸»è¦å†…å®¹ -->
        <main class="main-content">
            <!-- å·¦ä¾§å¤§çº²å±•ç¤ºåŒº -->
            <section class="outline-section">
                <div class="section-header">
                    <h1 class="section-title">
                        ğŸ“– æ™ºèƒ½æ•…äº‹å¤§çº²
                        <span class="ai-indicator">AIç”Ÿæˆ</span>
                    </h1>
                    <button class="regenerate-btn" onclick="regenerateOutline()">
                        ğŸ”„ é‡æ–°ç”Ÿæˆ
                    </button>
                </div>

                <div class="timeline" id="timeline">
                    <div class="chapter beginning" onclick="editChapter(this, 0)">
                        <div class="chapter-header">
                            <h3 class="chapter-title">ç¬¬ä¸€ç« ï¼šæ„å¤–çš„å‘ç°</h3>
                            <span class="chapter-type">å¼€ç«¯</span>
                        </div>
                        <div class="chapter-content">
                            å°å¥³å­©è‰¾è‰åœ¨å®¶é‡Œçš„æ—§ç”µè„‘ä¸Šå‘ç°äº†ä¸€ä¸ªç¥ç§˜çš„ç¨‹åºã€‚å½“å¥¹å¥½å¥‡åœ°ç‚¹å‡»æ—¶ï¼Œå±å¹•çªç„¶é—ªçƒèµ·å¥‡å¼‚çš„å…‰èŠ’ï¼Œå‡ºç°äº†ä¸€ä¸ªè‡ªç§°æ˜¯"ç½‘ç»œå®ˆæŠ¤è€…"çš„AIåŠ©æ‰‹ã€‚AIå‘Šè¯‰å¥¹ï¼Œç½‘ç»œä¸–ç•Œæ­£é¢ä¸´ç€ç—…æ¯’çš„å¨èƒï¼Œéœ€è¦å¥¹çš„å¸®åŠ©ã€‚
                        </div>
                        <div class="chapter-tags">
                            <span class="tag">å¥½å¥‡å¿ƒ</span>
                            <span class="tag">ç¥ç§˜å…ƒç´ </span>
                            <span class="security-tag">ç½‘ç»œå®‰å…¨æ„è¯†</span>
                        </div>
                    </div>

                    <div class="chapter development" onclick="editChapter(this, 1)">
                        <div class="chapter-header">
                            <h3 class="chapter-title">ç¬¬äºŒç« ï¼šè¿›å…¥ç½‘ç»œä¸–ç•Œ</h3>
                            <span class="chapter-type">å‘å±•</span>
                        </div>
                        <div class="chapter-content">
                            è‰¾è‰è¢«ä¼ é€åˆ°äº†ä¸€ä¸ªç”±æ•°æ®å’Œä»£ç æ„æˆçš„å¥‡å¦™ä¸–ç•Œã€‚åœ¨è¿™é‡Œï¼Œå¥¹é‡åˆ°äº†å„ç§æ•°å­—ç”Ÿç‰©ï¼Œäº†è§£åˆ°ç—…æ¯’æ­£åœ¨ç ´åç½‘ç»œçš„å¹³è¡¡ã€‚AIåŠ©æ‰‹æ•™ä¼šå¥¹è¯†åˆ«å¯ç–‘é“¾æ¥å’Œä¿æŠ¤ä¸ªäººä¿¡æ¯çš„é‡è¦æ€§ï¼Œå¹¶èµ‹äºˆå¥¹"å®‰å…¨å¯†ç "çš„åŠ›é‡ã€‚
                        </div>
                        <div class="chapter-tags">
                            <span class="tag">ä¸–ç•Œæ„å»º</span>
                            <span class="tag">è§’è‰²æˆé•¿</span>
                            <span class="security-tag">å¯†ç å®‰å…¨</span>
                            <span class="security-tag">ä¸ªäººä¿¡æ¯ä¿æŠ¤</span>
                        </div>
                    </div>

                    <div class="chapter development" onclick="editChapter(this, 2)">
                        <div class="chapter-header">
                            <h3 class="chapter-title">ç¬¬ä¸‰ç« ï¼šç—…æ¯’çš„é˜´è°‹</h3>
                            <span class="chapter-type">å‘å±•</span>
                        </div>
                        <div class="chapter-content">
                            è‰¾è‰å‘ç°ç—…æ¯’å†›å›¢æ­£åœ¨ç½‘ç»œä¸­æ•£å¸ƒè™šå‡ä¿¡æ¯ï¼Œè¯•å›¾çªƒå–ç”¨æˆ·çš„ä¸ªäººæ•°æ®ã€‚å¥¹å­¦ä¼šäº†å¦‚ä½•è¯†åˆ«ç½‘ç»œé’“é±¼ã€éªŒè¯ä¿¡æ¯çœŸå®æ€§ï¼Œå¹¶ä¸å…¶ä»–ç½‘ç»œè‹±é›„è”æ‰‹ï¼Œå‡†å¤‡å¯¹æŠ—ç—…æ¯’çš„å¨èƒã€‚
                        </div>
                        <div class="chapter-tags">
                            <span class="tag">å†²çªå‡çº§</span>
                            <span class="tag">å›¢é˜Ÿåˆä½œ</span>
                            <span class="security-tag">ç½‘ç»œé’“é±¼é˜²æŠ¤</span>
                            <span class="security-tag">ä¿¡æ¯è¾¨åˆ«</span>
                        </div>
                    </div>

                    <div class="chapter climax" onclick="editChapter(this, 3)">
                        <div class="chapter-header">
                            <h3 class="chapter-title">ç¬¬å››ç« ï¼šæœ€ç»ˆå¯¹å†³</h3>
                            <span class="chapter-type">é«˜æ½®</span>
                        </div>
                        <div class="chapter-content">
                            ç—…æ¯’å¤´ç›®å‘åŠ¨æœ€åçš„æ”»å‡»ï¼Œè¯•å›¾æ§åˆ¶æ•´ä¸ªç½‘ç»œä¸–ç•Œã€‚è‰¾è‰è¿ç”¨æ‰€å­¦çš„ç½‘ç»œå®‰å…¨çŸ¥è¯†ï¼Œä¸ä¼™ä¼´ä»¬æºæ‰‹åˆ›å»ºäº†å¼ºå¤§çš„é˜²ç«å¢™ã€‚åœ¨æ¿€çƒˆçš„æˆ˜æ–—ä¸­ï¼Œå¥¹ç”¨æ™ºæ…§å’Œå‹‡æ°”ï¼Œæœ€ç»ˆæˆ˜èƒœäº†ç—…æ¯’ï¼Œæ¢å¤äº†ç½‘ç»œä¸–ç•Œçš„å’Œå¹³ã€‚
                        </div>
                        <div class="chapter-tags">
                            <span class="tag">é«˜æ½®å¯¹å†³</span>
                            <span class="tag">æ™ºæ…§èƒœåˆ©</span>
                            <span class="security-tag">é˜²ç«å¢™</span>
                            <span class="security-tag">ç½‘ç»œé˜²æŠ¤</span>
                        </div>
                    </div>

                    <div class="chapter ending" onclick="editChapter(this, 4)">
                        <div class="chapter-header">
                            <h3 class="chapter-title">ç¬¬äº”ç« ï¼šç½‘ç»œå®ˆæŠ¤è€…</h3>
                            <span class="chapter-type">ç»“å±€</span>
                        </div>
                        <div class="chapter-content">
                            å›åˆ°ç°å®ä¸–ç•Œçš„è‰¾è‰æˆä¸ºäº†çœŸæ­£çš„ç½‘ç»œå®‰å…¨å°å«å£«ã€‚å¥¹å°†æ‰€å­¦çš„çŸ¥è¯†åˆ†äº«ç»™åŒå­¦ä»¬ï¼Œæ•™å¤§å®¶å¦‚ä½•å®‰å…¨åœ°ä½¿ç”¨äº’è”ç½‘ã€‚AIåŠ©æ‰‹æ‰¿è¯ºä¼šç»§ç»­åœ¨ç½‘ç»œä¸–ç•Œå®ˆæŠ¤å¤§å®¶çš„å®‰å…¨ï¼Œè€Œè‰¾è‰ä¹Ÿæ˜ç™½äº†ç½‘ç»œå®‰å…¨çš„é‡è¦æ€§ã€‚
                        </div>
                        <div class="chapter-tags">
                            <span class="tag">æˆé•¿å®Œæˆ</span>
                            <span class="tag">çŸ¥è¯†ä¼ æ’­</span>
                            <span class="security-tag">å®‰å…¨æ„è¯†</span>
                            <span class="security-tag">è´£ä»»æ„Ÿ</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- å³ä¾§ç¼–è¾‘æ§åˆ¶åŒº -->
            <aside class="control-section">
                <!-- AIåŠ©æ‰‹é¢æ¿ -->
                <div class="control-panel">
                    <h3 class="panel-title">ğŸ¤– AIåˆ›ä½œåŠ©æ‰‹</h3>
                    <div class="ai-assistant">
                        <div class="ai-avatar" onclick="showAITip()">ğŸ¤–</div>
                        <div class="ai-message" id="aiMessage">
                            è¿™ä¸ªæ•…äº‹å¾ˆæ£’ï¼æˆ‘ä¸ºä½ å·§å¦™åœ°èå…¥äº†ç½‘ç»œå®‰å…¨æ•™è‚²å…ƒç´ ã€‚ç‚¹å‡»ä»»æ„ç« èŠ‚å¯ä»¥ç¼–è¾‘å†…å®¹ï¼Œæˆ‘ä¼šæä¾›æ›´å¤šå»ºè®®ï¼
                        </div>
                    </div>
                    <div class="ai-suggestions">
                        <button class="suggestion-btn" onclick="applySuggestion('emotion')">ğŸ’ å¢åŠ æƒ…æ„Ÿæ·±åº¦</button>
                        <button class="suggestion-btn" onclick="applySuggestion('security')">ğŸ›¡ï¸ å¼ºåŒ–å®‰å…¨æ•™è‚²</button>
                        <button class="suggestion-btn" onclick="applySuggestion('character')">ğŸ‘¥ ä¸°å¯Œè§’è‰²æè¿°</button>
                        <button class="suggestion-btn" onclick="applySuggestion('scene')">ğŸ¬ å¢åŠ åœºæ™¯ç»†èŠ‚</button>
                    </div>
                </div>

                <!-- ç¼–è¾‘æ§åˆ¶é¢æ¿ */
                <div class="control-panel">
                    <h3 class="panel-title">âœï¸ ç¼–è¾‘å·¥å…·</h3>
                    <div class="edit-controls">
                        <button class="control-btn" onclick="addChapter()">
                            â• æ·»åŠ ç« èŠ‚
                        </button>
                        <button class="control-btn secondary" onclick="reorderChapters()">
                            ğŸ”€ è°ƒæ•´é¡ºåº
                        </button>
                        <button class="control-btn secondary" onclick="exportOutline()">
                            ğŸ“„ å¯¼å‡ºå¤§çº²
                        </button>
                        <button class="control-btn danger" onclick="resetOutline()">
                            ğŸ—‘ï¸ é‡ç½®å¤§çº²
                        </button>
                    </div>
                </div>

                <!-- æ•…äº‹ç»Ÿè®¡é¢æ¿ -->
                <div class="control-panel">
                    <h3 class="panel-title">ğŸ“Š æ•…äº‹ç»Ÿè®¡</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value">5</span>
                            <span class="stat-label">ç« èŠ‚æ•°é‡</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">3-5</span>
                            <span class="stat-label">é¢„è®¡æ—¶é•¿(åˆ†é’Ÿ)</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">8</span>
                            <span class="stat-label">å®‰å…¨çŸ¥è¯†ç‚¹</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">85%</span>
                            <span class="stat-label">æ•™è‚²ä»·å€¼</span>
                        </div>
                    </div>
                </div>

                <!-- ç½‘ç»œå®‰å…¨æ•™è‚²é¢æ¿ -->
                <div class="control-panel security-panel">
                    <h3 class="panel-title">ğŸ›¡ï¸ å®‰å…¨æ•™è‚²è¦ç‚¹</h3>
                    <div class="security-tip">
                        <span class="security-icon">ğŸ¯</span>
                        <div>
                            æœ¬æ•…äº‹åŒ…å«äº†å¯†ç å®‰å…¨ã€ä¸ªäººä¿¡æ¯ä¿æŠ¤ã€ç½‘ç»œé’“é±¼è¯†åˆ«ç­‰8ä¸ªæ ¸å¿ƒå®‰å…¨çŸ¥è¯†ç‚¹ï¼Œå¸®åŠ©å°æœ‹å‹å»ºç«‹è‰¯å¥½çš„ç½‘ç»œå®‰å…¨ä¹ æƒ¯ã€‚
                        </div>
                    </div>
                </div>
            </aside>
        </main>
    </div>

    <!-- åº•éƒ¨æ“ä½œåŒº -->
    <div class="bottom-actions">
        <div class="action-buttons">
            <div class="btn-group">
                <button class="btn-secondary" onclick="goBack()">â† é‡æ–°æ„æ€</button>
                <button class="btn-secondary" onclick="saveOutline()">ğŸ’¾ ä¿å­˜å¤§çº²</button>
            </div>
            <div class="btn-group">
                <button class="btn-primary" onclick="confirmOutline()">
                    ç¡®è®¤å¤§çº²ï¼Œç”Ÿæˆå‰§æœ¬ â†’
                </button>
            </div>
        </div>
    </div>

    <!-- ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <h3 class="modal-title">ç¼–è¾‘ç« èŠ‚</h3>
            <textarea class="edit-textarea" id="editTextarea" placeholder="ç¼–è¾‘ç« èŠ‚å†…å®¹..."></textarea>
            <div class="modal-buttons">
                <button class="btn-secondary" onclick="closeEditModal()">å–æ¶ˆ</button>
                <button class="btn-primary" onclick="saveChapterEdit()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <script>
        let currentEditingChapter = null;
        let currentEditingIndex = -1;

        // ç²’å­èƒŒæ™¯åŠ¨ç”»
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 60;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 25 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 20) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // ç¼–è¾‘ç« èŠ‚
        function editChapter(chapterElement, index) {
            currentEditingChapter = chapterElement;
            currentEditingIndex = index;
            
            const content = chapterElement.querySelector('.chapter-content').textContent.trim();
            document.getElementById('editTextarea').value = content;
            document.getElementById('editModal').style.display = 'flex';
            
            // é«˜äº®æ­£åœ¨ç¼–è¾‘çš„ç« èŠ‚
            document.querySelectorAll('.chapter').forEach(ch => ch.classList.remove('editing'));
            chapterElement.classList.add('editing');
        }

        // å…³é—­ç¼–è¾‘æ¨¡æ€æ¡†
        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
            document.querySelectorAll('.chapter').forEach(ch => ch.classList.remove('editing'));
            currentEditingChapter = null;
            currentEditingIndex = -1;
        }

        // ä¿å­˜ç« èŠ‚ç¼–è¾‘
        function saveChapterEdit() {
            if (currentEditingChapter) {
                const newContent = document.getElementById('editTextarea').value.trim();
                if (newContent) {
                    currentEditingChapter.querySelector('.chapter-content').textContent = newContent;
                    updateAIMessage('ç« èŠ‚å†…å®¹å·²æ›´æ–°ï¼æˆ‘æ³¨æ„åˆ°ä½ çš„ä¿®æ”¹å¾ˆæ£’ï¼Œä¿æŒäº†æ•…äº‹çš„è¿è´¯æ€§ã€‚');
                }
            }
            closeEditModal();
        }

        // é‡æ–°ç”Ÿæˆå¤§çº²
        function regenerateOutline() {
            if (confirm('ç¡®å®šè¦é‡æ–°ç”Ÿæˆå¤§çº²å—ï¼Ÿå½“å‰çš„ä¿®æ”¹å°†ä¼šä¸¢å¤±ã€‚')) {
                const regenerateBtn = document.querySelector('.regenerate-btn');
                regenerateBtn.innerHTML = '<div class="loading"></div> ç”Ÿæˆä¸­...';
                regenerateBtn.disabled = true;
                
                // æ¨¡æ‹ŸAIé‡æ–°ç”Ÿæˆ
                setTimeout(() => {
                    // è¿™é‡Œå¯ä»¥æ·»åŠ æ–°çš„å¤§çº²ç”Ÿæˆé€»è¾‘
                    updateAIMessage('å¤§çº²å·²é‡æ–°ç”Ÿæˆï¼æˆ‘ä¿æŒäº†æ ¸å¿ƒçš„ç½‘ç»œå®‰å…¨æ•™è‚²ä¸»é¢˜ï¼Œä½†è°ƒæ•´äº†ä¸€äº›ç»†èŠ‚è®©æ•…äº‹æ›´ç²¾å½©ã€‚');
                    regenerateBtn.innerHTML = 'ğŸ”„ é‡æ–°ç”Ÿæˆ';
                    regenerateBtn.disabled = false;
                }, 3000);
            }
        }

        // åº”ç”¨AIå»ºè®®
        function applySuggestion(type) {
            const suggestions = {
                emotion: 'æˆ‘ä¼šä¸ºæ¯ä¸ªç« èŠ‚å¢åŠ æ›´å¤šæƒ…æ„Ÿæè¿°ï¼Œè®©è§’è‰²æ›´æœ‰è¡€æœ‰è‚‰ï¼Œè®©è¯»è€…æ›´å®¹æ˜“äº§ç”Ÿå…±é¸£ã€‚',
                security: 'æˆ‘ä¼šåœ¨ç°æœ‰åŸºç¡€ä¸Šå¢åŠ æ›´å¤šç½‘ç»œå®‰å…¨çŸ¥è¯†ç‚¹ï¼Œæ¯”å¦‚ç¤¾äº¤å·¥ç¨‹ã€è½¯ä»¶æ›´æ–°ç­‰é‡è¦æ¦‚å¿µã€‚',
                character: 'æˆ‘ä¼šä¸°å¯Œä¸»è§’å’Œé…è§’çš„æ€§æ ¼ç‰¹ç‚¹ï¼Œç»™ä»–ä»¬ç‹¬ç‰¹çš„èƒŒæ™¯æ•…äº‹å’Œæˆé•¿è½¨è¿¹ã€‚',
                scene: 'æˆ‘ä¼šä¸ºæ¯ä¸ªåœºæ™¯æ·»åŠ æ›´å¤šè§†è§‰ç»†èŠ‚ï¼Œè®©ç½‘ç»œä¸–ç•Œæ›´åŠ ç”ŸåŠ¨æœ‰è¶£ã€‚'
            };
            
            updateAIMessage(suggestions[type] || 'å¥½çš„å»ºè®®ï¼æˆ‘ä¼šå¸®ä½ ä¼˜åŒ–æ•…äº‹å†…å®¹ã€‚');
            
            // æ¨¡æ‹Ÿåº”ç”¨å»ºè®®çš„æ•ˆæœ
            document.querySelectorAll('.chapter').forEach(chapter => {
                chapter.style.transform = 'scale(1.02)';
                setTimeout(() => {
                    chapter.style.transform = 'scale(1)';
                }, 300);
            });
        }

        // æ›´æ–°AIæ¶ˆæ¯
        function updateAIMessage(message) {
            const aiMessage = document.getElementById('aiMessage');
            aiMessage.style.opacity = '0';
            setTimeout(() => {
                aiMessage.textContent = message;
                aiMessage.style.opacity = '1';
            }, 150);
        }

        // æ˜¾ç¤ºAIæç¤º
        function showAITip() {
            const tips = [
                'ğŸ’¡ ç‚¹å‡»ä»»æ„ç« èŠ‚éƒ½å¯ä»¥ç¼–è¾‘å†…å®¹å“¦ï¼',
                'ğŸŒŸ è¿™ä¸ªæ•…äº‹çš„ç½‘ç»œå®‰å…¨æ•™è‚²å…ƒç´ è®¾è®¡å¾—å¾ˆæ£’ï¼',
                'ğŸ¨ å¯ä»¥å°è¯•è°ƒæ•´ç« èŠ‚é¡ºåºæ¥ä¼˜åŒ–æ•…äº‹èŠ‚å¥ï¼',
                'ğŸ”® æˆ‘å¯ä»¥å¸®ä½ å¢åŠ æ›´å¤šæœ‰è¶£çš„æƒ…èŠ‚ï¼'
            ];
            
            const randomTip = tips[Math.floor(Math.random() * tips.length)];
            updateAIMessage(randomTip);
        }

        // æ·»åŠ ç« èŠ‚
        function addChapter() {
            const newChapterHTML = `
                <div class="chapter development" onclick="editChapter(this, 5)">
                    <div class="chapter-header">
                        <h3 class="chapter-title">æ–°ç« èŠ‚ï¼šç‚¹å‡»ç¼–è¾‘æ ‡é¢˜</h3>
                        <span class="chapter-type">å‘å±•</span>
                    </div>
                    <div class="chapter-content">
                        ç‚¹å‡»ç¼–è¾‘è¿™ä¸ªç« èŠ‚çš„å†…å®¹...
                    </div>
                    <div class="chapter-tags">
                        <span class="tag">æ–°ç« èŠ‚</span>
                    </div>
                </div>
            `;
            
            document.getElementById('timeline').insertAdjacentHTML('beforeend', newChapterHTML);
            updateAIMessage('æ–°ç« èŠ‚å·²æ·»åŠ ï¼è®°å¾—ä¸ºå®ƒç¼–å†™ç²¾å½©çš„å†…å®¹ã€‚');
            
            // æ›´æ–°ç»Ÿè®¡
            const chapterCount = document.querySelector('.stat-value');
            chapterCount.textContent = parseInt(chapterCount.textContent) + 1;
        }

        // è°ƒæ•´ç« èŠ‚é¡ºåº
        function reorderChapters() {
            updateAIMessage('ä½ å¯ä»¥æ‹–æ‹½ç« èŠ‚æ¥è°ƒæ•´é¡ºåºï¼Œæˆ–è€…é€šè¿‡ç¼–è¾‘æ¥é‡æ–°ç»„ç»‡æ•…äº‹ç»“æ„ã€‚');
        }

        // å¯¼å‡ºå¤§çº²
        function exportOutline() {
            const chapters = document.querySelectorAll('.chapter');
            let outlineText = 'æ•…äº‹å¤§çº²\n\n';
            
            chapters.forEach((chapter, index) => {
                const title = chapter.querySelector('.chapter-title').textContent;
                const content = chapter.querySelector('.chapter-content').textContent;
                outlineText += `${index + 1}. ${title}\n${content}\n\n`;
            });
            
            const blob = new Blob([outlineText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'æ•…äº‹å¤§çº².txt';
            a.click();
            URL.revokeObjectURL(url);
            
            updateAIMessage('å¤§çº²å·²å¯¼å‡ºï¼ä½ å¯ä»¥ä¿å­˜åˆ°æœ¬åœ°æˆ–åˆ†äº«ç»™å…¶ä»–äººã€‚');
        }

        // é‡ç½®å¤§çº²
        function resetOutline() {
            if (confirm('ç¡®å®šè¦é‡ç½®å¤§çº²å—ï¼Ÿæ‰€æœ‰ä¿®æ”¹éƒ½å°†ä¸¢å¤±ã€‚')) {
                location.reload();
            }
        }

        // ä¿å­˜å¤§çº²
        function saveOutline() {
            // æ¨¡æ‹Ÿä¿å­˜åˆ°äº‘ç«¯
            const saveBtn = document.querySelector('.btn-secondary[onclick="saveOutline()"]');
            const originalText = saveBtn.textContent;
            saveBtn.innerHTML = '<div class="loading"></div> ä¿å­˜ä¸­...';
            saveBtn.disabled = true;
            
            setTimeout(() => {
                saveBtn.textContent = 'âœ… å·²ä¿å­˜';
                updateAIMessage('å¤§çº²å·²ä¿å­˜åˆ°äº‘ç«¯ï¼å¯ä»¥éšæ—¶å›æ¥ç»§ç»­ç¼–è¾‘ã€‚');
                
                setTimeout(() => {
                    saveBtn.textContent = originalText;
                    saveBtn.disabled = false;
                }, 2000);
            }, 1500);
        }

        // è¿”å›ä¸Šä¸€é¡µ
        function goBack() {
            if (confirm('ç¡®å®šè¦è¿”å›é‡æ–°æ„æ€å—ï¼Ÿå½“å‰çš„å¤§çº²ä¿®æ”¹å°†ä¼šä¸¢å¤±ã€‚')) {
                window.history.back();
            }
        }

        // ç¡®è®¤å¤§çº²
        function confirmOutline() {
            updateAIMessage('å¤ªæ£’äº†ï¼æ¥ä¸‹æ¥æˆ‘å°†åŸºäºè¿™ä¸ªå¤§çº²ä¸ºä½ ç”Ÿæˆè¯¦ç»†çš„å‰§æœ¬å’Œåˆ†é•œå¤´è„šæœ¬ã€‚');
            
            // ä¿å­˜å¤§çº²æ•°æ®
            const outlineData = {
                chapters: Array.from(document.querySelectorAll('.chapter')).map(chapter => ({
                    title: chapter.querySelector('.chapter-title').textContent,
                    content: chapter.querySelector('.chapter-content').textContent,
                    type: chapter.querySelector('.chapter-type').textContent
                }))
            };
            localStorage.setItem('storyOutline', JSON.stringify(outlineData));
            
            // è·³è½¬åˆ°ä¸‹ä¸€æ­¥
            setTimeout(() => {
                window.location.href = 'script-generation.html';
            }, 1500);
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            
            // å¦‚æœæœ‰ä¿å­˜çš„åˆ›æ„ï¼Œæ˜¾ç¤ºç›¸å…³ä¿¡æ¯
            const savedIdea = localStorage.getItem('storyIdea');
            if (savedIdea) {
                updateAIMessage(`åŸºäºä½ çš„åˆ›æ„"${savedIdea.substring(0, 50)}..."ï¼Œæˆ‘ç”Ÿæˆäº†è¿™ä¸ªç²¾å½©çš„æ•…äº‹å¤§çº²ï¼`);
            }
            
            // æ·»åŠ æ»šåŠ¨åŠ¨ç”»
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateX(0)';
                    }
                });
            });
            
            document.querySelectorAll('.chapter').forEach(chapter => {
                chapter.style.opacity = '0';
                chapter.style.transform = 'translateX(-20px)';
                chapter.style.transition = 'all 0.5s ease';
                observer.observe(chapter);
            });
        });

        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', function(event) {
            if (event.ctrlKey || event.metaKey) {
                switch(event.key) {
                    case 's':
                        event.preventDefault();
                        saveOutline();
                        break;
                    case 'Enter':
                        if (document.getElementById('editModal').style.display === 'flex') {
                            event.preventDefault();
                            saveChapterEdit();
                        }
                        break;
                }
            }
            
            if (event.key === 'Escape') {
                if (document.getElementById('editModal').style.display === 'flex') {
                    closeEditModal();
                }
            }
        });
    </script>
</body>
</html> 